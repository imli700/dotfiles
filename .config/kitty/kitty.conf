# ~/.config/kitty/kitty.conf
#
# FINAL VERSION - All functional and visual fixes included.

#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
#                           Appearance
#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

font_family      "JetBrainsMono Nerd Font Mono"
font_size        16.0
term             xterm-256color

# --- Visual Change 1: Transparency ---
# This matches the "#e5" alpha from your wezterm config.
background_opacity 0.9

# --- Colors ---
foreground       #fff4d2
background       #222222
cursor           #928374
cursor_text_color #222222
selection_foreground #222222
selection_background #fff4d2
color0  #1d1d1d
color1  #cc241d
color2  #98971a
color3  #d79921
color4  #458588
color5  #b16286
color6  #689d6a
color7  #a89984
color8  #a89984
color9  #fb4934
color10 #b8bb26
color11 #fabd2f
color12 #83a598
color13 #d3869b
color14 #8ec07c
color15 #fff4d2


#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
#                         Tab Bar Appearance
#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

tab_bar_edge     bottom
tab_title_template "{'#[Z] ' if layout_name == 'stack' else ''}{index}: {title}"

# --- Visual Change 2: Clean, Solid Tabs ---
# Replace the ugly "fade" style with a modern powerline look.
tab_bar_style powerline
tab_powerline_style slanted

# Set colors for active vs inactive tabs to create a solid look.
active_tab_foreground   #222222
active_tab_background   #fff4d2
active_tab_font_style   bold
inactive_tab_foreground #fff4d2
inactive_tab_background #444444
inactive_tab_font_style normal
tab_bar_background      #1d1d1d


#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
#                           Behavior
#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

enable_audio_bell no
scrollback_lines 10000
allow_remote_control yes
confirm_os_window_close 0


#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
#                         Keybindings
#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

# --- Global Keybindings ---
map alt+tab next_tab
map f1 show_kitty_doc overview
map ctrl+shift+5 launch --location=vsplit --cwd=current
map ctrl+shift+' launch --location=hsplit --cwd=current

# --- Kitty Pane Navigation ---
# Use Ctrl+Shift+h/j/k/l to navigate kitty panes.
# This leaves Ctrl+h/j/k/l free for Neovim.
map ctrl+shift+h neighboring_window left
map ctrl+shift+j neighboring_window down
map ctrl+shift+k neighboring_window up
map ctrl+shift+l neighboring_window right

# --- Tmux-style Leader Key ---
map --new-mode leader_mode alt+m

# --- Bindings active inside leader_mode (Tmux-style: exit mode after use) ---

# tmux-style pane splitting under the leader key
map --mode leader_mode shift+5 combine : launch --location=vsplit --cwd=current : pop_keyboard_mode
map --mode leader_mode shift+apostrophe combine : launch --location=hsplit --cwd=current : pop_keyboard_mode

# Tab Management
map --mode leader_mode c combine : new_tab_with_cwd : pop_keyboard_mode
map --mode leader_mode n combine : next_tab : pop_keyboard_mode
map --mode leader_mode p combine : previous_tab : pop_keyboard_mode
map --mode leader_mode & combine : close_tab : pop_keyboard_mode
map --mode leader_mode , combine : set_tab_title : pop_keyboard_mode

# Pane/Window Management
map --mode leader_mode x combine : close_window : pop_keyboard_mode
enabled_layouts tall,stack
map --mode leader_mode z combine : toggle_layout stack : scroll_prompt_to_bottom : pop_keyboard_mode

# Misc - We can simplify the scrollback pager mapping slightly
# A more robust scrollback pager that starts in normal mode.
scrollback_pager sh -c "perl -pe 's/\\033\\[[0-?]*[ -\\/]*[@-~]//g; s/\\033\\][^\\033\\007]*(?:\\007|\\033\\\\)//g' | nvim -u NONE -c 'set nonumber nornu readonly' -c 'set clipboard=unnamedplus' -"
map --mode leader_mode [ combine : show_scrollback : pop_keyboard_mode

# Manually cancel leader mode
map --mode leader_mode escape pop_keyboard_mode

# Numeric tab navigation
map --mode leader_mode 1 combine : goto_tab 1 : pop_keyboard_mode
map --mode leader_mode 2 combine : goto_tab 2 : pop_keyboard_mode
map --mode leader_mode 3 combine : goto_tab 3 : pop_keyboard_mode
map --mode leader_mode 4 combine : goto_tab 4 : pop_keyboard_mode
map --mode leader_mode 5 combine : goto_tab 5 : pop_keyboard_mode
map --mode leader_mode 6 combine : goto_tab 6 : pop_keyboard_mode
map --mode leader_mode 7 combine : goto_tab 7 : pop_keyboard_mode
map --mode leader_mode 8 combine : goto_tab 8 : pop_keyboard_mode
map --mode leader_mode 9 combine : goto_tab 9 : pop_keyboard_mode

# --- Disabled Defaults ---
map alt+enter no_op

# Resizing splits
map alt+shift+l resize_window narrower
map alt+shift+h resize_window wider
map alt+shift+k resize_window taller
map alt+shift+j resize_window shorter
